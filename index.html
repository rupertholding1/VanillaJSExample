<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Payments API Explorer</title>
  <style>
    :root { --ink:#111; --muted:#6b7280; --line:#e5e7eb; }
    * { box-sizing:border-box; }
    body { margin:0; padding:24px; color:var(--ink); background:#fff;
           font:14px/1.5 ui-sans-serif,system-ui,-apple-system,"Segoe UI",Inter,Roboto,Arial; }
    .wrap { max-width:860px; margin:0 auto; }
    h1 { font-size:18px; margin:0 0 8px; }
    p.note { margin:0 0 16px; color:var(--muted); }
    .card { border:1px solid var(--line); border-radius:10px; padding:16px; }
    label { display:block; font-size:12px; color:var(--muted); margin:12px 0 6px; }
    input, select, textarea { width:100%; border:1px solid var(--line); border-radius:8px; padding:10px 12px; font:inherit; }
    textarea { min-height:110px; font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:12px; }
    .grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .row { display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px; }
    .btns { display:flex; gap:8px; margin-top:12px; }
    button { appearance:none; border:1px solid var(--line); background:#f8fafc; padding:10px 14px; border-radius:8px; cursor:pointer; }
    pre { margin:0; background:#f8fafc; border:1px solid var(--line); border-radius:8px; padding:12px; overflow:auto;
          font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:12px; }
    .split { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
    .mt24 { margin-top:24px; }
    .small { font-size:12px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Payments API Explorer</h1>
    <p class="note small">Minimal demo: build a request → send with <code>fetch</code> → inspect URL, headers and JSON response. Swap Base URL to a Postman mock or sandbox.</p>

    <div class="split">
      <!-- Request -->
      <div class="card">
        <label>Base URL</label>
        <input id="baseUrl" value="https://reqres.in" />

        <div class="grid">
          <div>
            <label>Operation</label>
            <select id="op">
              <option value="create">Create (POST)</option>
              <option value="get">Get (GET)</option>
              <option value="refund">Refund (POST)</option>
            </select>
          </div>
          <div>
            <label>Auth (Bearer, optional)</label>
            <input id="auth" placeholder="e.g. demo-token" />
          </div>
        </div>

        <div class="row">
          <div>
            <label>Amount</label>
            <input id="amount" type="number" value="1999" />
          </div>
          <div>
            <label>Currency</label>
            <input id="currency" value="GBP" />
          </div>
          <div>
            <label>Payment ID (for Get/Refund)</label>
            <input id="paymentId" value="2" />
          </div>
        </div>

        <label>Request Body (auto)</label>
        <textarea id="body" readonly></textarea>

        <div class="btns">
          <button id="copyCurl">Copy cURL</button>
          <button id="send">Send</button>
        </div>
      </div>

      <!-- Response -->
      <div class="card">
        <div class="grid">
          <div>
            <label>Status</label>
            <input id="status" readonly value="—" />
          </div>
          <div>
            <label>Duration (ms)</label>
            <input id="dur" readonly value="—" />
          </div>
        </div>

        <label>URL</label>
        <pre id="url">—</pre>

        <label>Request Headers</label>
        <pre id="reqHeaders">—</pre>

        <label>Response Body</label>
        <pre id="resp">—</pre>
      </div>
    </div>

    <!-- Logic Sandbox -->
    <h1 class="mt24">Logic Sandbox</h1>
    <p class="note small">Bubble sort with a <code>swapped</code> flag and <code>do…while</code> loop (like in the interview):</p>
    <div class="card">
      <label>Numbers</label>
      <input id="nums" value="5, 3, 8, 1, 4" />
      <div class="btns"><button id="runLogic">Run Example</button></div>
      <label>Console Output</label>
      <pre id="logicOut">—</pre>
    </div>

    <p class="note small mt24">No keys stored. Pure client-side. Suitable for GitHub Pages.</p>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);
    const els = {
      baseUrl: $('baseUrl'), op: $('op'), auth: $('auth'), amount: $('amount'), currency: $('currency'),
      paymentId: $('paymentId'), body: $('body'), copyCurl: $('copyCurl'), send: $('send'),
      status: $('status'), dur: $('dur'), url: $('url'), reqHeaders: $('reqHeaders'), resp: $('resp'),
      nums: $('nums'), runLogic: $('runLogic'), logicOut: $('logicOut')
    };

    function buildUrl() {
      const base = (els.baseUrl.value || '').replace(/\/$/, '');
      if (els.op.value === 'create') return base + '/api/users';
      if (els.op.value === 'get') return base + '/api/users/' + (els.paymentId.value || '2');
      if (els.op.value === 'refund') return base + '/api/users';
      return base;
    }
    function buildMethod() { return els.op.value === 'get' ? 'GET' : 'POST'; }
    function buildPayload() {
      if (els.op.value === 'get') return undefined;
      if (els.op.value === 'refund') return { payment_id: els.paymentId.value || '2', reason: 'customer_request' };
      return { amount: Number(els.amount.value || 0), currency: (els.currency.value || 'GBP').toUpperCase(), method: 'card' };
    }

    function updatePreview() {
      const url = buildUrl();
      const headers = { 'Content-Type': 'application/json' };
      if (els.auth.value) headers['Authorization'] = 'Bearer ' + els.auth.value.trim();
      const payload = buildPayload();

      els.body.value = payload ? JSON.stringify(payload, null, 2) : '— (GET request)';
      els.url.textContent = url;
      els.reqHeaders.textContent = JSON.stringify(headers, null, 2);
      els.status.value = '—';
      els.dur.value = '—';
      els.resp.textContent = '—';
    }
    ['change','keyup'].forEach(evt => {
      ['baseUrl','op','auth','amount','currency','paymentId'].forEach(id =>
        els[id].addEventListener(evt, updatePreview)
      );
    });

    els.copyCurl.addEventListener('click', async () => {
      const method = buildMethod();
      const url = buildUrl();
      const headers = { 'Content-Type': 'application/json' };
      if (els.auth.value) headers['Authorization'] = 'Bearer ' + els.auth.value.trim();
      const payload = buildPayload();
      const curl = [
        'curl', '-X', method, `'${url}'`,
        '-H', `'Content-Type: application/json'`,
        ...(headers.Authorization ? ['-H', `'Authorization: ${headers.Authorization}'`] : []),
        ...(payload ? ['-d', `'${JSON.stringify(payload).replace(/'/g, "'\\''")}'`] : [])
      ].join(' ');
      try { await navigator.clipboard.writeText(curl); } catch {}
    });

    els.send.addEventListener('click', async () => {
      const method = buildMethod();
      const url = buildUrl();
      const headers = { 'Content-Type': 'application/json' };
      if (els.auth.value) headers['Authorization'] = 'Bearer ' + els.auth.value.trim();
      const init = { method, headers };
      const payload = buildPayload();
      if (payload) init.body = JSON.stringify(payload);

      const t0 = performance.now();
      try {
        const res = await fetch(url, init);
        const t1 = performance.now();
        els.status.value = res.status + ' ' + res.statusText;
        els.dur.value = Math.round(t1 - t0);
        const txt = await res.text();
        try { els.resp.textContent = JSON.stringify(JSON.parse(txt), null, 2); }
        catch { els.resp.textContent = txt; }
      } catch (e) {
        els.status.value = 'Network error';
        els.resp.textContent = e.message;
      }
    });

    // Logic Sandbox — bubble sort with swapped flag
    function bubbleSortTrace(list) {
      const a = list.slice();
      const logs = [];
      let swapped;
      do {
        swapped = false;
        for (let i = 0; i < a.length - 1; i++) {
          if (a[i] > a[i+1]) {
            const t = a[i]; a[i] = a[i+1]; a[i+1] = t;
            swapped = true;
          }
        }
        logs.push('Pass: ' + JSON.stringify(a));
      } while (swapped);
      logs.push('Sorted: ' + JSON.stringify(a));
      return logs.join('\n');
    }
    els.runLogic.addEventListener('click', () => {
      const nums = els.nums.value.split(/[,\s]+/).filter(Boolean).map(Number);
      els.logicOut.textContent = bubbleSortTrace(nums);
    });

    updatePreview();
  </script>
</body>
</html>
