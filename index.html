<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Payments API Explorer</title>
  <style>
    :root { --ink:#111; --muted:#6b7280; --line:#e5e7eb; }
    * { box-sizing:border-box; }
    body { margin:0; padding:24px; color:var(--ink); background:#fff;
           font:14px/1.5 ui-sans-serif,system-ui,-apple-system,"Segoe UI",Inter,Roboto,Arial; }
    .wrap { max-width:860px; margin:0 auto; }
    h1 { font-size:18px; margin:0 0 8px; }
    p.note { margin:0 0 16px; color:var(--muted); }
    .card { border:1px solid var(--line); border-radius:10px; padding:16px; }
    label { display:block; font-size:12px; color:var(--muted); margin:12px 0 6px; }
    input, select, textarea { width:100%; border:1px solid var(--line); border-radius:8px; padding:10px 12px; font:inherit; }
    textarea { min-height:110px; font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:12px; }
    .grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .row { display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px; }
    .btns { display:flex; gap:8px; margin-top:12px; }
    button { appearance:none; border:1px solid var(--line); background:#f8fafc; padding:10px 14px; border-radius:8px; cursor:pointer; }
    pre { margin:0; background:#f8fafc; border:1px solid var(--line); border-radius:8px; padding:12px; overflow:auto;
          font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:12px; }
    .split { display:grid; grid-template-columns:1fr 1fr; gap:16px; }
    .small { font-size:12px; }
  </style>
</head>

<body>
  <div class="wrap">
    <h1>Payments API Explorer</h1>
 

    <div class="split">
      <!-- Request -->
      <div class="card">
        <label>Base URL</label>
        <input id="baseUrl" value="https://jsonplaceholder.typicode.com/posts" />

        <div class="grid">
          <div>
            <label>Operation</label>
            <select id="operation">
              <option value="create">Create (POST)</option>
              <option value="get">Get (GET)</option>
            </select>
          </div>
          <div>
            <label>Auth (Bearer, optional)</label>
            <input id="auth" placeholder="e.g. demo-token" />
          </div>
        </div>

        <div class="row">
          <div>
            <label>Amount</label>
            <input id="amount" type="number" value="1994" />
          </div>
          <div>
            <label>Currency</label>
            <input id="currency" value="GBP" />
          </div>
          <div>
            <label>Payment ID (for GET)</label>
            <input id="paymentId" value="1" />
          </div>
        </div>

        <label>Request Body (readonly)</label>
        <textarea id="body" readonly></textarea>

        <div class="btns">
          <button id="copyCurl">Copy cURL</button>
          <button id="send">Send</button>
        </div>
      </div>

      <!-- Response -->
      <div class="card">
        <div class="grid">
          <div>
            <label>Status</label>
            <input id="status" readonly value="—" />
          </div>
          <div>
            <label>Duration (ms)</label>
            <input id="dur" readonly value="—" />
          </div>
        </div>

        <label>URL</label>
        <pre id="url">—</pre>

        <label>Request Headers</label>
        <pre id="reqHeaders">—</pre>

        <label>Response Body</label>
        <pre id="resp">—</pre>
      </div>
    </div>

    <p class="note small" style="margin-top:20px">
      Client side only no keys stored, works from git pages.
    </p>

  

  <script>
    const $ = (id) => document.getElementById(id);
    const els = {
      baseUrl: $('baseUrl'), op: $('operation'), auth: $('auth'), amount: $('amount'),
      currency: $('currency'), paymentId: $('paymentId'), body: $('body'),
      copyCurl: $('copyCurl'), send: $('send'), status: $('status'),
      dur: $('dur'), url: $('url'), reqHeaders: $('reqHeaders'), resp: $('resp')
    };

    // API Explorer Core
    function buildUrl() {
      const base = 'https://jsonplaceholder.typicode.com';
      if (els.op.value === 'get') return `${base}/posts/${els.paymentId.value || 1}`;
      return `${base}/posts`;
    }

    function buildMethod() { return els.op.value === 'get' ? 'GET' : 'POST'; }

    function buildPayload() {
      if (els.op.value === 'get') return undefined;
      return {
        title: "Payments API Explorer",
        body: `amount=${Number(els.amount.value || 0)}&currency=${(els.currency.value||'GBP').toUpperCase()}`,
        userId: 1
      };
    }

    function preRequestScript(payload) {
      if (!payload) return payload;
      payload.sent_at = new Date().toISOString();
      console.log('[Pre-request]', payload);
      return payload;
    }

    function runTests(json, status) {
      const ok = status === 201 || status === 200;
      console.log('[Tests]', { status, ok, hasId: !!json.id, response: json });
    }

    async function sendRequest() {
      const url = buildUrl();
      const method = buildMethod();
      const headers = { 'Content-Type': 'application/json' };
      if (els.auth.value) headers['Authorization'] = 'Bearer ' + els.auth.value.trim();
      const payload = buildPayload();
      const processed = payload ? preRequestScript(payload) : undefined;

      const init = { method, headers };
      if (processed) init.body = JSON.stringify(processed);

      const t0 = performance.now();
      try {
        const res = await fetch(url, init);
        const t1 = performance.now();
        els.status.value = res.status + ' ' + res.statusText;
        els.dur.value = Math.round(t1 - t0);
        const data = await res.json();
        els.url.textContent = url;
        els.reqHeaders.textContent = JSON.stringify(headers, null, 2);
        els.resp.textContent = JSON.stringify(data, null, 2);
        runTests(data, res.status);
      } catch (e) {
        els.status.value = 'Network error';
        els.resp.textContent = e.message;
      }
    }

    els.send.addEventListener('click', sendRequest);
    ['change','keyup'].forEach(evt => {
      ['operation','auth','amount','currency','paymentId'].forEach(id =>
        els[id].addEventListener(evt, () => {
          const p = buildPayload();
          els.body.value = p ? JSON.stringify(p, null, 2) : '— (GET request)';
        })
      );
    });

    els.copyCurl.addEventListener('click', async () => {
      const method = buildMethod();
      const url = buildUrl();
      const headers = { 'Content-Type': 'application/json' };
      if (els.auth.value) headers['Authorization'] = 'Bearer ' + els.auth.value.trim();
      const payload = buildPayload();
      const curl = [
        'curl', '-X', method, `'${url}'`,
        '-H', `'Content-Type: application/json'`,
        ...(headers.Authorization ? ['-H', `'Authorization: ${headers.Authorization}'`] : []),
        ...(payload ? ['-d', `'${JSON.stringify(payload).replace(/'/g, "'\\''")}'`] : [])
      ].join(' ');
      try { await navigator.clipboard.writeText(curl); alert('Copied cURL to clipboard'); } catch {}
    });

    // Initial render
    els.body.value = JSON.stringify(buildPayload(), null, 2);

   
  </script>
</body>
</html>
